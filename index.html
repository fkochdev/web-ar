<!DOCTYPE html>
<html>
  <head>
    <title>WebAR Marker</title>
    <meta name="WebAR Marker Samples" content="WebAR Sample">
    <link id="favicon" rel="icon" href="https://glitch.com/edit/favicon-app.ico" type="image/x-icon">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!--meta name="viewport" content="width=device-width, initial-scale=1"-->
    <meta name="apple-mobile-web-app-capable" content="yes">
<script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
<script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
<!--script src="https://unpkg.com/aframe-look-at-component/dist/aframe-look-at-component.min.js"></script-->
<script src="https://fcor.github.io/arjs-gestures/gesture-detector.js"></script>
<script src="https://fcor.github.io/arjs-gestures/gesture-handler.js"></script>



    <style type="text/css">

		p {
		  font-family: Arial, Helvetica, sans-serif;
		}

		a:link, 
		a:visited,
		a:hover,
		a:active {
		  color: white;
		}

      #splash {
        display: flex;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;

        align-items: center;
        justify-content: center;
        
        background: rgba(0, 0, 0, 1);
        color: white;
        cursor: pointer;
        z-index: 999;
        font-size: 6vw;
      }

      #camhint {
        display: flex;
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;

        align-items: center;
        justify-content: center;
        
        background: rgba(0, 0, 0, 1);
        color: white;
        cursor: pointer;
        z-index: -2;
        font-size: 2vw;
      }

      #impressum {
        display: flex;
        position: fixed;
        top: 90%;
        left: 0;
        right: 0;
        bottom: 0;

        align-items: center;
        justify-content: center;
        
        background: rgba(0, 0, 0, 1);
        color: white;
        cursor: pointer;
        z-index: 999;
        font-size: 1.5vw;
      }
    </style>
    <script>
		AFRAME.registerComponent('vidhandler', {
         init: function () {
          this.toggle = false;
          document.querySelector("#video").pause(); //reference to the video
         },
         tick:function(){  
         if(document.querySelector("#videoMarker").object3D.visible == true){
           if(!this.toggle){
             this.toggle = true;
             document.querySelector("#video").play();
           }
         }else{
           this.toggle = false;
           document.querySelector("#video").pause();
         }
         }
         });

      document.addEventListener("DOMContentLoaded", function(event) {
        var scene = document.querySelector("a-scene");
        var vid = document.getElementById("video");

		document.querySelector('#splash').style.display = 'flex';
        document.querySelector('#splash').addEventListener('click', function () {
	        vid.play();
        	this.style.display = 'none';
        })
      });


	/*AFRAME.registerComponent('change-models', {
    init: function () {
     this.display = document.querySelector("#display");
     		var textVar = "Set text here"; 
		this.display.setAttribute('text','value',textVar);
     this.el.addEventListener("click",this.onClick.bind(this));
     this.modelHouseCar = document.querySelector("#houseandcar");
     this.modelWine = document.querySelector("#wine");
    },
    onClick:function()
    {
    	var textDebug = "clicked"; 
		this.display.setAttribute('text','value',textDebug);
      if (this.modelHouseCar.visible)
      {
      	textDebug = "house visible";
		this.display.setAttribute('text','value',textDebug);

      	this.modelHouseCar.setAttribute('visible','false');
		this.modelWine.setAttribute('visible','true');
		textDebug = "Wine"; 
		this.display.setAttribute('text','value',textVar);

      }
      else //if (document.getElementById("#houseandcar").visible)
      {
      	this.modelHouseCar.setAttribute('visible','true');
		this.modelWine.setAttribute('visible','false'); 
		textDebug = "HouseCar"; 
		this.display.setAttribute('text','value',textVar);

      }
    }
  });*/
    </script>

  </head>
  <body>

<div id="camhint">
      <div id="start-button">
      	<p align="center">Please allow camera access.</p>
      	<p align="center">Bitte Kamera-Zugriff erlauben.</p>

      </div>
    </div>

 <div id="splash">
      <div id="start-button">
      	<p align="center">Start WebAR</p>

      </div>
    </div>

     <div id="impressum">
      	<p align="center">(c) 2020, Florian Koch / <a href="mailto:fkoch.dev@gmail.com" color="black">info (a) designed-dreams.de</a> v.2020130615</p>
    </div>

    <a-scene 
    vr-mode-ui="enabled: false;"
    device-orientation-permission-ui="enabled: false;"
    renderer="antialias: true; logarithmicDepthBuffer: true; colorManagement: true;"
    embedded
    arjs="trackingMethod: best; sourceType: webcam; debugUIEnabled: false;"
    light="defaultLightsEnabled: false;"
    gesture-detector
    >

    	<a-assets>
        	<video webkit-playsinline playsinline crossorigin="anonymous" type="video/mp4" id="video" loop="true" src="models/video.mp4"></video>
        	        <a-asset-item id="car" src="models/car.glb"></a-asset-item>
        	        <a-asset-item id="car2" src="models/car2.glb"></a-asset-item>

        	        <a-asset-item id="fashion" src="models/fashion.glb"></a-asset-item>
        	        <a-asset-item id="house" src="models/House.gltf"></a-asset-item>
        	        <a-asset-item id="shoe" src="models/shoe.glb"></a-asset-item>

		    <!--img id="location" src="images/location.jpg"-->
  		</a-assets>

-
        <!--a-light color="white" position="-15 15 -15" distance="200" intensity="1"></a-light-->
		<a-entity light="type: ambient; color: #ffffe0; intensity: 1;"></a-entity>
       <a-light type="directional" color="white" target="#lightTarget" position="1 1 1" intensity="1.4"></a-light>

       <!--a-marker preset="custom" type="pattern" url="marker/marker0.patt">  
	       <a-entity gltf-model="models/elephant.glb" position="0 0 0" scale="1 1 1"></a-entity>     
	   </a-marker-->	

	 
       <!--a-marker preset="custom" type="pattern" url="marker/marker1.patt" raycaster="objects: .clickable" emitevents="true" cursor="fuse: false; rayOrigin: mouse;">
            <a-entity id="houseandcar" visible="true" class="clickable" gesture-handler="minScale: 0.25; maxScale: 10" rotation="0 -35 0" >
	            <a-entity gltf-model="models/car.glb" id="lightTarget" position="-0.45 0.05 -2.2" rotation="0 90 0" scale="0.25 0.25 0.25"></a-entity>	
	            <a-entity gltf-model="models/House.gltf" position="0 0 0" scale="0.003 0.003 0.003"></a-entity>
            </a-entity>     

            <a-entity id="wine" visible="false" gltf-model="models/wineglass.glb" id="lightTarget" rotation="180 0 0" position="2 0 0" scale="0.7 0.7 0.7" class="clickable" gesture-handler="minScale: 0.1; maxScale: 10"></a-entity>	

			<a-entity look-at=[camera]>
		  		<a-entity id = "menu1" rotation="0 180 0" position = "-2 0 0" geometry = "primitive: plane; height: 1; width: 1" material = "color:black" text="color: white; align: center; value: 1; width: 5; value: '<'" change-models></a-entity>
		    	<a-entity id = "menu2" rotation="0 180 0" position = "2 0 0" geometry = "primitive: plane; height: 1; width: 1" material = "color:black" text="color: white; align: center; value: 1; width: 5; value: '>'" change-models></a-entity>
	          	<a-entity id ="display" position="0 2 0" geometry="primitive: plane; height: 1; width: 3" material="color: teal" text="color: white; align: center; value: 1; width: 5; value: 'modelname'"></a-entity>
	      	</a-entity>

        </a-marker-->

 		<a-marker preset="custom" type="pattern" url="marker/marker_fk.patt" raycaster="objects: .clickable" emitevents="true" cursor="fuse: false; rayOrigin: mouse;">  
	        <a-entity class="clickable" gesture-handler="minScale: 0.25; maxScale: 10">
		        <a-entity gltf-model="#car" id="lightTarget" position="-0.45 0.05 -2.2" rotation="0 90 0" scale="0.25 0.25 0.25"></a-entity>	
	            <a-entity gltf-model="#house" position="0 0 0" scale="0.003 0.003 0.003"></a-entity>
            </a-entity>  

	   </a-marker>	

          <a-marker preset="custom" id="videoMarker" type="pattern" url="marker/50/pattern-kola.patt">  
	       <a-video src="#video" width="2.56" height="1.44" position="0 0 0" rotation="-90 0 0" vidhandler></a-video>
	       	        <a-entity gltf-model="#car2" id="lightTarget" position="0 0 0" rotation="0 55 0" scale="1 1 1" class="clickable" gesture-handler="minScale: 0.25; maxScale: 10">

	   </a-marker>	
      

        <a-marker preset="custom" type="pattern" url="marker/50/pattern-car.patt" raycaster="objects: .clickable" emitevents="true" cursor="fuse: false; rayOrigin: mouse;">
	        <a-entity gltf-model="#car2" id="lightTarget" position="0 0 0" rotation="0 55 0" scale="1 1 1" class="clickable" gesture-handler="minScale: 0.25; maxScale: 10">
            </a-entity>
        </a-marker>

        <a-marker preset="custom" type="pattern" url="marker/50/pattern-house.patt" raycaster="objects: .clickable" emitevents="true" cursor="fuse: false; rayOrigin: mouse;">
            <a-entity gltf-model="#house" position="0 0 0" scale="0.003 0.003 0.003" visible="true" class="clickable" gesture-handler="minScale: 0.25; maxScale: 10" rotation="0 -35 0" >
            </a-entity>     
         </a-marker>

		<a-marker preset="custom" type="pattern" url="marker/50/pattern-shoe.patt" raycaster="objects: .clickable" emitevents="true" cursor="fuse: false; rayOrigin: mouse;">
	        <a-entity gltf-model="#shoe" id="lightTarget" position="0 0 0" rotation="0 90 0" scale="5 5 5" class="clickable" gesture-handler="minScale: 0.25; maxScale: 10">
            </a-entity>
        </a-marker>

		<!--a-marker preset="custom" type="pattern" url="marker/50/pattern-fashion.patt" raycaster="objects: .clickable" emitevents="true" cursor="fuse: false; rayOrigin: mouse;">
	        <a-entity gltf-model="#fashion" id="lightTarget" position="0 0 0" rotation="0 180 0" scale="1 1 1" animation="property: rotation; from: 0 0 0; to: 0 540 0; loop: true; easing: linear; dur: 20000" class="clickable" gesture-handler="minScale: 0.25; maxScale: 10; rotationFactor: 0">
            </a-entity>
        </a-marker-->

       


		<!--a-text
	        value="China-\nRestaurant" 
	        look-at="[gps-camera]"
	        scale="50 50 50"
	        gps-entity-place="latitude: 53.4870566; longitude: 10.1453014;"
      	></a-text>
      	  <a-image src="#location"
      	  	look-at="[gps-camera]"
	        scale="1 1 1"
	        gps-entity-place="latitude: 53.4870566; longitude: 10.1453014;">
      	  </a-image>
      	<a-text
	        value="Café Bistro Nes"
	        look-at="[gps-camera]"
	        scale="1 1 1"
	        gps-entity-place="latitude: 53.4923279; longitude: 10.1243976;"
      	></a-text>
      	  <a-image src="#location"
      	  	look-at="[gps-camera]"
	        scale="1 1 1"
	        gps-entity-place="latitude: 53.4923279; longitude: 10.1243976;">
      	  </a-image-->

      <a-entity camera></a-entity>
      <!--a-camera gps-camera rotation-reader></a-camera-->

  </body>
</html>